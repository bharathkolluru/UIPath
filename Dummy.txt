In Bernoulli's Naive Bayes classification initial steps are the same. We first need to construct our
dictionary. If the training documents remain same dictionary will be same. Let us reproduce our
training documents and the dictionary constructed using those documents.

ð· 1 = Upgrad is a great educational institution

ð· 2 = Educational greatness depends on ethics

ð· 3 = A story of great ethics and educational greatness

ð· 4 =Sholay is a great cinema

ð· 5 =good movie depends on good story

These documents will give following dictionary vector as we have already seen in the case of
Multinomial Naive Bayes.

0 1 2 3 4 5 6 7 8 9 10 11

cinema depends educational ethics good great greatness institution movie shola stor upgra
y y d

Now we need to vectorize our training documents according to this dictionary. Vectorization
process for Bernoulli's Naive Bayes is different from Multinomial Naive Bayes. Let us first see the
vectorized feature vector for Multinomial Naive Bayes.

ïƒ¦0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1 ïƒ¶
ïƒ§ ïƒ·
ïƒ§0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0 ïƒ·
D = ïƒ§ 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0 ïƒ·
ïƒ§ ïƒ·
ïƒ§1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0ïƒ·
ïƒ§ ïƒ·
ïƒ¨0, 1, 0, 0, 2, 0, 0, 0, 1, 0, 1, 0ïƒ¸

Notice a '2' at the bottom row of the matrix. Last row is the feature vector for our fifth document.
As the fifth document ( ð· 5 =good movie depends on good story ) contains word "good" twice , it
has appeared as 2 in 5th column of the last row. In Multinomial Naive Bayes, feature vectors
capture the frequency of the words in the document.

Bernoulli's feature vectors are a bit different. It generates a Boolean indicator about each term of
the vocabulary and equals to 1 if the term belongs to the examining document and 0 if it does
not. Let us see the feature vector of our document for better understanding.ïƒ¦0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1 ïƒ¶
ïƒ§ ïƒ·
ïƒ§0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0 ïƒ·
D = ïƒ§ 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0 ïƒ·
ïƒ§ ïƒ·
ïƒ§1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0ïƒ·
ïƒ§ ïƒ·
ïƒ¨0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0 ïƒ¸

See the difference. We have only 0's and 1's. The '2' of the last row has disappeared. We are only
interested whether a word appears in a document or not.

Thus each document is represented as a 12-dimensional binary vector. Let us separate them acco
rding to their class.

ïƒ¦0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1ïƒ¶
ð‘Žð‘Žð‘ ð‘Žð‘Žð‘ ð‘–ð‘™ð‘™ ïƒ§ ïƒ·
ð· = ïƒ§0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0ïƒ·
ïƒ§ ïƒ·
ïƒ¨0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0 ïƒ¸

ð‘Žð‘–ð‘™ð‘Žð‘™ð‘Ž ïƒ¦1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0ïƒ¶
ð·     = ïƒ§ ïƒ·
ïƒ§ ïƒ·
ïƒ¨0, 1, 0, 0, 2, 0, 0, 0, 1, 0, 1, 0ïƒ¸

Now how do we calculate the probability of a word occurring in a class. For example what is the
probability of the word "ethics" appearing in the class "educationâ€?  Means we are formally
trying to find outP(w=ethics | C=education). How do we calculate this? Not as we did while
calculating the same expression in Multinomial Naive Bayes. It is calculated using following
formula

n education ï€¨ w ethics ï€©
P (w=ethics | C=education)=
N education
. n education ï€¨ w ethics ï€© means total no of word "ethics" in all the documents of class "education" and
N education means total no of documents in class " education". n education ï€¨ w ethics ï€© our example is 2 and
N education  is 3. So, the probability of the word "ethics" appearing in the class "education" is
n education ï€¨ w ethics ï€© 2
=  .
N education 3Now let us make a table showing probability of all the words in all the classes of documents using
our feature vector of documents as we did for Multinomial Naive Bayes.

n education ï€¨ w ï€© p ï€¨ w | c ï€½ education ï€© n cinema ï€¨ w ï€© p ï€¨ w | c ï€½ cinema ï€©

ð‘¤ 1 = cinema 0 0 1 1/2

ð‘¤ 2 = depends 1 1/3 1 1/2

ð‘¤ 3 = educational 3 3/3 =1 0 0

ð‘¤ 4 = ethics 2 2/3 0 0

ð‘¤ 5 = good 0 0 2 2/2=1

ð‘¤ 6 = great 2 2/3 1 1/2

ð‘¤ 7 = greatness 2 2/3 0 0

ð‘¤ 8 = institution 1 1/3 0 0

ð‘¤ 9 = movie 0 0 1 1/2

ð‘¤ 10 = sholey 0 0 1 1/2

ð‘¤ 11 = story 1 1/3 1 1/2

ð‘¤ 12 = upgrad 1 1/3 0 0

Suppose we want to classify following document into "education" or "cinema".

â€œvery good educational institutionâ€

Let us first recall our Bayesâ€™s formula written to suit hour this discussion.

Likelihood Prior

P ï€¨ C | 1 , w 2 ,.... w n ï€© ï€½ P ï€¨ w 1 , w 2 ,.... w n | C ï€© * P ï€¨ C ï€©
w P ï€¨ w 1 , w 2 ,.... w n ï€©
Normalization Constant
Posterior

d

hoodDenominator of the right-hand side expression is generally ignored as that will be same for all
cases and hence doesnâ€™t affect the final outcome. Let us calculate the â€œPriorâ€. â€œPriorâ€ is our prior
knowledge of probability of a document of belonging to a certain class. For this discussion we will
restrict to two classes â€œeducationâ€ and â€œcinemaâ€. So what is the probability of a document
belonging to â€œeducation â€œclass?

P ï€¨ education ï€© ï€½ # ð‘™ð‘Ž ð‘Žð‘™ð‘Žð‘ ð‘™ð‘Žð‘™ð‘  ð‘Žð‘Žð‘™ð‘™ð‘™ð‘Žð‘–ð‘™ð‘Ž ð‘ ð‘™ ð‘ â„Žð‘Ž ð‘Žð‘™ð‘Žð‘ ð‘  "ð‘Žð‘Žð‘ ð‘Žð‘Žð‘ ð‘–ð‘™ð‘™"
# ð‘™ð‘Ž ð‘ ð‘™ð‘ ð‘Žð‘™ ð‘Žð‘™ð‘Žð‘ ð‘™ð‘Žð‘™ð‘ ð‘ 

= 3 = 0.6
5

Similarly

P ï€¨ cinema ï€© ï€½ # ð‘™ð‘Ž ð‘Žð‘™ð‘Žð‘ ð‘™ð‘Žð‘™ð‘  ð‘Žð‘Žð‘™ð‘™ð‘™ð‘Žð‘–ð‘™ð‘Ž ð‘ ð‘™ ð‘ â„Žð‘Ž ð‘Žð‘™ð‘Žð‘ ð‘  "ð‘Žð‘–ð‘™ð‘Žð‘™ð‘Ž" = 2 = 0.4
# ð‘™ð‘Ž ð‘ ð‘™ð‘ ð‘Žð‘™ ð‘Žð‘™ð‘Žð‘ ð‘™ð‘Žð‘™ð‘ ð‘  5

These figures are our prior beliefs about any documents belonging to a certain class. Given any
new document we believe that its probability of belonging it to education class is 60%.

Now let us focus on the likelihood term. Let P(w |C) be the probability of word w occurring in a
document of class C; the probability of w not occurring in a document of this class is given by
(1âˆ’P(w |C)). If we make the naive Bayes assumption, that the probability of each word occurring
in the document is independent of the occurrences of the other words, then we can write the
document likelihood P(D | C) in terms of the individual word likelihoods P(w |C):
P ï€¨ , ,.... | C ï€© = P(d|C) = |V| [ P( | C) ï€« (1ï€­ )(1ï€­ P( | C)]
w 1 w 2 w n ïƒ• d i w i d i w i
iï€½1

What is d in the above expression ?

d = (ð’… ðŸŽ, ð’… ðŸŽ, ð’… ðŸŽ, ð’… ðŸŽ, ð’… ðŸŽ, ð’… ðŸŽ, ð’… ðŸŽ, ð’… ðŸŽ, ð’… ðŸŽ, ð’… ðŸŽðŸŽ, ð’… ðŸŽðŸŽ, ð’… ðŸŽðŸŽ ) is a feature vector of any document.

ð’… ð’Š could be either â€œ0â€ or â€œ1â€. When ð’… ð’Š =1 then(ðŸŽ âˆ’ ð’… ð’Š )=0 and When  ð’… ð’Š =0 then(ðŸŽ âˆ’
ð’… ð’Š )=1. That means any one of the terms d i P( w i | C) or (1ï€­ d i )(1ï€­ P( w i | C)in the  likelihood
expression will be non-zero.This product goes over all words in the vocabulary. If word w i is
present, then  ð’… ð’Š =1 and the required probability is P( w i | C) ; if word w i is not present, then
ð’… ð’Š =0 and the required probability is 1ï€­ P( w i | C) .
So how should we proceed to calculate likelihood of our test document â€œvery good educational
institutionâ€. Its going to be different than how we calculated it for Multinomial NaÃ¯ve Bayes. That
might have been obvious from the likelihood equation for Bernoulliâ€™s NaÃ¯ve Bayes. We didnâ€™tbother about feature vector of test document then. But now we need to transform our test
document to a feature vector as we did for training documents. So feature vector for our test
document will be

d = (0,0,1,0,1,0,0,1,0,0,0,0) . It was to know what our feature vector would be. There are 4 words.

First, we should ignore those words in the document which are not part of the dictionary. In this
case the word â€œveryâ€ is not part of the dictionary so we should ignore it.We only need to consider
remaining words which are â€œgoodâ€ , â€œeducationalâ€ and â€œinstitutionâ€ . Feature vector has three â€œ1â€
corresponding to these words at ð’… ðŸŽ, ð’… ðŸŽ, andð’… ðŸŽ, .All other values of feature vector are zero as
these words donâ€™t appear in our test document.

d = (0,0,1,0,1,0,0,1,0,0,0,0)

12
P(education|d) âˆ P(education) ïƒ• [ d i P( w i | C ï€½ education) ï€« (1ï€­ d i )(1ï€­ P( w i | C ï€½ education))]
iï€½1

âˆ ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ
ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ

Let us see reasoning for few terms to understand the above expression.

First term -> ðŸŽ
ðŸŽ
This is prior for education and equal to P(education)

Second term -> 1  First term ð’… ðŸŽ, of the feature vector is 0 so we use
(1ï€­ d i )(1ï€­ P( w i | C ï€½ education)) . By putting ð’… ðŸŽ, =0 and P( w 1 | C ï€½ education) =0 we get 1
Third term-> ðŸŽ Second  term ð’… of the feature vector is 0 again so we again use
ðŸŽ ðŸŽ,
ðŸŽ
(1ï€­ d i )(1ï€­ P( w i | C ï€½ education)) . By putting ð’… ðŸŽ =0 and P( w 2 | C ï€½ education) = ðŸŽ  form the
probability table we get ðŸŽ .
ðŸŽ

Fourth term -> ðŸŽ Third  term ð’… ðŸŽ, of the feature vector is 1 a so we  use
d i P( w i | C ï€½ education) . By putting ð’… ðŸŽ =1 and P( w 3 | C ï€½ education) =1 form the probability
table we get ðŸŽ.Fifth term -> ðŸŽ Fourth  term ð’… ðŸŽ of the feature vector is 0  so we again use
ðŸŽ
ðŸŽ
(1ï€­ d i )(1ï€­ P( w i | C ï€½ education)) . By putting ð’… ðŸŽ =0 and P( w 4 | C ï€½ education) = ðŸŽ  form the
probability table we get ðŸŽ .
ðŸŽ

Sixth term -> 0 . This is special and needs our extra attention. This will make the whole expression
zero. Fifth term ð’… ðŸŽ of the feature vector is 1 a so we use d i P( w i | C ï€½ education) . By putting
ð’… ðŸŽ =1 and P( w 5 | C ï€½ education) =0 from the probability table we get 0 .

There is no point for any further calculations. In Multinomial Naive Bayes we have already seen
how to handle this. We use Laplace Smoothing. Formula of Laplace Smoothing for Bernoulli's Naive
Bayes is a bit different and as follows.

n C ï€¨ w t ï€© ï€«1
P(ð’˜ ð’• | C)=
N C ï€« 2
n C ï€¨ w t ï€©     is the number of documents in class C in which word w t    is present and

N C             is total no of documents in class C .      Derivation of this formula is beyond the scope of
this discussion. Let us use this formula to recalculate our probability table for dictionary words for
different classes.

n education ï€¨ w ï€© p ï€¨ w | c ï€½ education ï€© n cinema ï€¨ w ï€© p ï€¨ w | c ï€½ cinema ï€©

ð‘¤ 1 = cinema 0+1=1 1/(2+3)=1/5 1+1=2 2/(2+2)=1/2

ð‘¤ 2 = depends 1+1=2 2/(2+3)=2/5 1+1=2 2/(2+2)=1/2

ð‘¤ 3 = educational 3+1=4 4/(2+3)=4/5 0+1=1 1/(2+2)=1/4

ð‘¤ 4 = ethics 2+1=3 3/(2+3)=3/5 0+1=1 1/(2+2)=1/4

ð‘¤ 5 = good 0+1=1 1/(2+3)=1/5 2+1=3 3/(2+2)=3/4

ð‘¤ 6 = great 2+1=3 3/(2+3)=3/5 1+1=2 2/(2+2)=1/4

ð‘¤ 7 = greatness 2+1=3 3/(2+3)=3/5 0+1=1 1/(2+2)=1/4ð‘¤ 8 = institution 1+1=2 2/(2+3)=2/5 0+1=1 1/(2+2)=1/4

ð‘¤ 9 = movie 0+1=1 1/(2+3)=1/5 1+1=2 2/(2+2)=1/2

ð‘¤ 10 = sholey 0+1=1 1/(2+3)=1/5 1+1=2 2/(2+2)=1/2

ð‘¤ 11 = story 1+1=2 2/(2+3)=2/5 1+1=2 2/(2+2)=1/2

ð‘¤ 12 = upgrad 1+1=2 2/(2+3)=2/5 0+1=1 1/(2+2)=1/4

Now let us use this table to calculate the class of the test document which feature vector is given
by  d = (0,0,1,0,1,0,0,1,0,0,0,0)

We will use same formula and steps.

12
P(education|d) âˆ P(education) ïƒ• [ d i P( w i | C ï€½ education) ï€« (1ï€­ d i )(1ï€­ P( w i | C ï€½ education))]
iï€½1

âˆ ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ
ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ

= 0.0002717908992

12
P(cinema|d) âˆ P(cinema) ïƒ• [ d i P( w i | C ï€½ cinema) ï€« (1ï€­ d i )(1ï€­ P( w i | C ï€½ cinema))]
iï€½1

âˆ ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ Ã— ðŸŽ
ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ ðŸŽ

= 0.000185394287109375

As P(education|d) > P(cinema|d)  we can conclude that the document belongs to "education"
class.

As you notice that the model of this variation is significantly different from Multinomial not only
because it does not take into consideration the number of occurrences of each word, but also
because it takes into account the non-occurring terms within the document. While in Multinomial
model the non-occurring terms are completely ignored, in Bernoulli model they are factored when
computing the conditional probabilities and thus the absence of terms is taken into account.